This repository was made in an attempt to reproduce a bug where inner transaction amounts are off by a small amount of microAlgos (~10). 

# Setup
To setup the repo, run `make init`

# Testing
To run a loop of the tests, run `./loop_test.sh`

# Debugging
To execute a tealdbg session with the dryrun generated by the test txn run `./debug.sh`

# Example Failure
This failure was with `itxnAmount = 1_001`
```
Test iteration: 7
eval "rm -f tests/*.teal tests/index.js* tests/dryruns/*"
cd tests && ../contract.py && npx tsc && npx jest
 FAIL  ./index.js
  App Call
    ✕ receiever balance increase (5 ms)
    ✕ app balance decrease (4 ms)

  ● App Call › receiever balance increase

    expect(received).toBe(expected) // Object.is equality

    Expected: 10000001
    Received: 10000011

      275 |   it('receiever balance increase', async () => {
      276 |     const balance = (await algodClient.accountInformation(receiver.addr).do()).amount
    > 277 |     expect(balance).toBe(preReceiverBalance + itxnAmount - 1_000)
          |                     ^
      278 |   })
      279 |
      280 |   it('app balance decrease', async () => {

      at index.ts:277:21
      at fulfilled (index.js:51:24)

  ● App Call › app balance decrease

    expect(received).toBe(expected) // Object.is equality

    Expected: 998999
    Received: 999000

      280 |   it('app balance decrease', async () => {
      281 |     const balance = (await algodClient.accountInformation(appAccount.addr).do()).amount
    > 282 |     expect(balance).toBe(preAppBalance - itxnAmount)
          |                     ^
      283 |   })
      284 |
      285 |   afterAll(async () => {

      at index.ts:282:21
      at fulfilled (index.js:51:24)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 2 total
Snapshots:   0 total
Time:        1.125 s, estimated 2 s
Ran all test suites.
make: *** [test] Error 1
```